This code is especially awful - I ripped it to pieces in the process of getting part 2 working :)